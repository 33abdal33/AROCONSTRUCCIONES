@model AROCONSTRUCCIONES.Dtos.ProveedorEdicionViewModelDto
@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers

@{
    bool esCrear = Model.Proveedor.Id == 0;
    string titulo = esCrear ? "Registrar Nuevo Proveedor" : "Actualizar Información del Socio";
    string accion = esCrear ? "Create" : "Edit";
    string subtitulo = esCrear ? "Complete los datos comerciales para dar de alta a un nuevo socio." : "Modifique los datos de contacto o especialidad del proveedor.";
}

<div x-data="{ open: true }"
     x-show="open"
     x-transition:enter="transition ease-out duration-300"
     x-transition:enter-start="opacity-0 scale-95"
     x-transition:enter-end="opacity-100 scale-100"
     class="fixed inset-0 z-[60] overflow-y-auto"
     style="display: none;">

    <div class="fixed inset-0 bg-slate-900/70 backdrop-blur-sm transition-opacity"></div>

    <div class="flex items-center justify-center min-h-screen p-4 text-center">
        <div x-on:click.away="open = false"
             class="relative bg-white rounded-[2rem] shadow-2xl transform transition-all sm:my-8 sm:max-w-3xl sm:w-full overflow-hidden border border-slate-200">

            <form id="formProveedor"
                  asp-action="@accion"
                  asp-controller="Proveedor"
                  asp-route-id="@Model.Proveedor.Id"
                  method="post"
                  data-form-ajax="true">

                @Html.AntiForgeryToken()
                <input type="hidden" asp-for="Proveedor.Id" />

                <div class="bg-slate-50 px-8 pt-8 pb-6 border-b border-slate-200 text-left">
                    <div class="flex items-center gap-4 mb-2">
                        <div class="w-12 h-12 bg-indigo-600 rounded-2xl flex items-center justify-center shadow-lg shadow-indigo-100">
                            <i class="fas fa-truck text-white text-xl"></i>
                        </div>
                        <div>
                            <h3 class="text-xl font-black text-slate-900 tracking-tight">@titulo</h3>
                            <p class="text-xs font-bold text-indigo-600 uppercase tracking-widest">Gestión de Socios Comerciales</p>
                        </div>
                    </div>
                    <p class="text-sm text-slate-700 font-medium">@subtitulo</p>
                </div>

                <div class="p-8 space-y-6 text-left max-h-[65vh] overflow-y-auto custom-scrollbar">

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-5">
                        <div class="space-y-2">
                            <label asp-for="Proveedor.RazonSocial" class="text-[11px] font-black text-slate-800 uppercase tracking-widest ml-1">Nombre o Razón Social *</label>
                            <div class="relative">
                                <span class="absolute inset-y-0 left-0 flex items-center pl-4 text-slate-500"><i class="fas fa-building text-xs"></i></span>
                                <input asp-for="Proveedor.RazonSocial" class="w-full pl-11 pr-4 py-3 rounded-xl border-2 border-slate-100 bg-slate-50 focus:bg-white focus:border-indigo-500 focus:ring-0 outline-none text-sm font-bold text-slate-900 transition-all" placeholder="EJ: Cementos del Pacífico S.A.C" required />
                            </div>
                        </div>
                        <div class="space-y-2">
                            <label asp-for="Proveedor.RUC" class="text-[11px] font-black text-slate-800 uppercase tracking-widest ml-1">Número de RUC *</label>
                            <div class="relative">
                                <span class="absolute inset-y-0 left-0 flex items-center pl-4 text-slate-500"><i class="fas fa-id-card text-xs"></i></span>
                                <input asp-for="Proveedor.RUC" class="w-full pl-11 pr-4 py-3 rounded-xl border-2 border-slate-100 bg-slate-50 focus:bg-white focus:border-indigo-500 focus:ring-0 outline-none text-sm font-mono font-bold text-slate-900 transition-all" placeholder="12345678901" required />
                            </div>
                        </div>
                    </div>

                    <div class="p-5 bg-slate-50 rounded-2xl border border-slate-100 space-y-4">
                        <p class="text-[10px] font-black text-indigo-600 uppercase tracking-[0.2em] mb-2">Información Bancaria (Para Pagos)</p>

                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <div class="space-y-1">
                                <label class="text-[10px] font-bold text-slate-500 ml-1">Banco</label>
                                <input asp-for="Proveedor.Banco" class="w-full px-4 py-2.5 rounded-lg border border-slate-200 text-sm font-bold text-slate-700 outline-none focus:border-indigo-400" placeholder="Ej: BCP, BBVA" />
                            </div>
                            <div class="md:col-span-2 space-y-1">
                                <label class="text-[10px] font-bold text-slate-500 ml-1">Número de Cuenta (Cuenta 1)</label>
                                <input asp-for="Proveedor.NumeroCuenta" class="w-full px-4 py-2.5 rounded-lg border border-slate-200 text-sm font-mono font-bold text-slate-700 outline-none focus:border-indigo-400" placeholder="000-0000000-0-00" />
                            </div>
                        </div>

                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div class="space-y-1">
                                <label class="text-[10px] font-bold text-slate-500 ml-1">Código Interbancario CCI (Cuenta 2)</label>
                                <input asp-for="Proveedor.CCI" class="w-full px-4 py-2.5 rounded-lg border border-slate-200 text-sm font-mono font-bold text-slate-700 outline-none focus:border-indigo-400" placeholder="002-000-000000000000-00" />
                            </div>
                            <div class="flex items-center justify-center pt-5">
                                <label class="flex items-center gap-3 cursor-pointer group">
                                    <input asp-for="Proveedor.TieneDetraccion" type="checkbox" class="w-5 h-5 text-indigo-600 border-slate-300 rounded focus:ring-indigo-500">
                                    <span class="text-xs font-black text-slate-600 uppercase tracking-tight group-hover:text-indigo-600">Aplica Detracción</span>
                                </label>
                            </div>
                        </div>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-5">
                        <div class="space-y-2">
                            <label asp-for="Proveedor.NombreContacto" class="text-[11px] font-black text-slate-800 uppercase tracking-widest ml-1">Persona de Contacto</label>
                            <input asp-for="Proveedor.NombreContacto" class="w-full px-4 py-3 rounded-xl border-2 border-slate-100 bg-slate-50 text-sm font-bold text-slate-900" placeholder="Nombre del vendedor" />
                        </div>
                        <div class="space-y-2">
                            <label asp-for="Proveedor.Telefono" class="text-[11px] font-black text-slate-800 uppercase tracking-widest ml-1">Teléfono</label>
                            <input asp-for="Proveedor.Telefono" class="w-full px-4 py-3 rounded-xl border-2 border-slate-100 bg-slate-50 text-sm font-bold text-slate-900" placeholder="+51..." />
                        </div>
                    </div>

                    <div class="space-y-2">
                        <label asp-for="Proveedor.Direccion" class="text-[11px] font-black text-slate-800 uppercase tracking-widest ml-1">Dirección Fiscal / Oficina</label>
                        <textarea asp-for="Proveedor.Direccion" class="w-full px-4 py-3 rounded-xl border-2 border-slate-100 bg-slate-50 text-sm font-medium text-slate-900" rows="2" placeholder="Calle, Distrito, Provincia..."></textarea>
                    </div>

                    <div class="flex items-center justify-between p-4 bg-indigo-50 rounded-2xl border border-indigo-100">
                        <div>
                            <p class="text-sm font-bold text-slate-900">Estado de Operación</p>
                            <p class="text-[10px] font-bold text-indigo-600 uppercase">Habilitar para órdenes de compra</p>
                        </div>
                        <label class="relative inline-flex items-center cursor-pointer">
                            <input asp-for="Proveedor.Estado" type="checkbox" class="sr-only peer">
                            <div class="w-11 h-6 bg-slate-300 rounded-full peer peer-checked:bg-indigo-600 after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:after:translate-x-full"></div>
                        </label>
                    </div>

                    <div class="pt-4 border-t border-slate-100">
                        <label class="text-[11px] font-black text-slate-800 uppercase tracking-widest ml-1">Materiales que Suministra *</label>
                        <div class="mt-3 bg-slate-50 rounded-2xl border-2 border-slate-100 p-4 h-40 overflow-y-auto custom-scrollbar">
                            @foreach (var material in Model.TodosLosMateriales)
                            {
                                <label class="flex items-center p-2 hover:bg-white rounded-lg cursor-pointer transition-all">
                                    <input type="checkbox" name="MaterialesAsignadosIds" value="@material.Id" @(Model.MaterialesAsignadosIds.Contains(material.Id) ? "checked" : "") class="w-4 h-4 text-indigo-600 rounded">
                                    <span class="ml-3 text-sm font-bold text-slate-700">@material.Nombre</span>
                                </label>
                            }
                        </div>
                    </div>
                </div>

                <div class="px-8 py-6 bg-slate-50 border-t border-slate-200 flex flex-col sm:flex-row-reverse gap-3">
                    <button type="submit" class="w-full sm:w-auto px-10 py-3 bg-indigo-600 hover:bg-indigo-700 text-white text-xs font-black rounded-xl shadow-lg transition-all uppercase tracking-widest">
                        <i class="fas fa-save mr-2"></i> Guardar Proveedor
                    </button>
                    <button type="button" x-on:click="open = false" class="w-full sm:w-auto px-10 py-3 bg-white border-2 border-slate-200 text-slate-800 text-xs font-black rounded-xl uppercase tracking-widest">
                        Cancelar
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>